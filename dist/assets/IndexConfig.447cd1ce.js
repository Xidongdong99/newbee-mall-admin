import"./vendor.9959cf56.js";/* empty css             *//* empty css               *//* empty css              */import{r as e,h as o,o as a,c as l,w as r,d as t,g as n,a as i,K as d,s,i as u,j as c,m as p,k as m,L as g,_ as f,x as y,v as b,e as h,M as v,N as _,O as k,P as x,E as F,n as T,Q as C,R as V,S as w,T as j,p as S,b as I}from"./index.0bf1171a.js";/* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css                *//* empty css                  */const P={class:"dialog-footer"},U={__name:"DialogAddGood",props:{type:String,configType:Number,reload:Function},setup(f,{expose:y}){const b=f,h=e(null),v=o({visible:!1,ruleForm:{name:"",link:"",id:"",sort:""},rules:{name:[{required:"true",message:"名称不能为空",trigger:["change"]}],id:[{required:"true",message:"编号不能为空",trigger:["change"]}],sort:[{required:"true",message:"排序不能为空",trigger:["change"]}]},id:""}),_=()=>{h.value.validate((e=>{if(e){if(v.ruleForm.id<0)return void d.error("商品编号不能小于 0 或大于 200");"add"==b.type?s.post("/indexConfigs",{configType:b.configType||3,configName:v.ruleForm.name,redirectUrl:v.ruleForm.link,goodsId:v.ruleForm.id,configRank:v.ruleForm.sort}).then((()=>{d.success("添加成功"),v.visible=!1,b.reload&&b.reload()})):s.put("/indexConfigs",{configId:v.id,configType:b.configType||3,configName:v.ruleForm.name,redirectUrl:v.ruleForm.link,goodsId:v.ruleForm.id,configRank:v.ruleForm.sort}).then((()=>{d.success("修改成功"),v.visible=!1,b.reload&&b.reload()}))}}))};return y({open:e=>{v.visible=!0,e?(v.id=e,(e=>{s.get(`/indexConfigs/${e}`).then((e=>{v.ruleForm={name:e.configName,id:e.goodsId,link:e.redirectUrl,sort:e.configRank}}))})(e)):v.ruleForm={name:"",id:"",link:"",sort:""}},close:()=>{v.visible=!1}}),(e,o)=>{const d=u,s=c,y=p,b=m,k=g;return a(),l(k,{title:"add"==f.type?"添加商品":"修改商品",modelValue:v.visible,"onUpdate:modelValue":o[5]||(o[5]=e=>v.visible=e),width:"400px"},{footer:r((()=>[t("span",P,[n(b,{onClick:o[4]||(o[4]=e=>v.visible=!1)},{default:r((()=>[i("取 消")])),_:1}),n(b,{type:"primary",onClick:_},{default:r((()=>[i("确 定")])),_:1})])])),default:r((()=>[n(y,{model:v.ruleForm,rules:v.rules,ref_key:"formRef",ref:h,"label-width":"100px",class:"good-form"},{default:r((()=>[n(s,{label:"商品名称",prop:"name"},{default:r((()=>[n(d,{type:"text",modelValue:v.ruleForm.name,"onUpdate:modelValue":o[0]||(o[0]=e=>v.ruleForm.name=e)},null,8,["modelValue"])])),_:1}),n(s,{label:"跳转链接",prop:"link"},{default:r((()=>[n(d,{type:"text",modelValue:v.ruleForm.link,"onUpdate:modelValue":o[1]||(o[1]=e=>v.ruleForm.link=e)},null,8,["modelValue"])])),_:1}),n(s,{label:"商品编号",prop:"id"},{default:r((()=>[n(d,{type:"number",min:"0",modelValue:v.ruleForm.id,"onUpdate:modelValue":o[2]||(o[2]=e=>v.ruleForm.id=e)},null,8,["modelValue"])])),_:1}),n(s,{label:"排序值",prop:"sort"},{default:r((()=>[n(d,{type:"number",modelValue:v.ruleForm.sort,"onUpdate:modelValue":o[3]||(o[3]=e=>v.ruleForm.sort=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}};const N={class:"header"},z=["onClick"],R=(e=>(S("data-v-7eee142b"),e=e(),I(),e))((()=>t("a",{style:{cursor:"pointer"}},"删除",-1)));var B=f({__name:"IndexConfig",setup(l){const u={hot:3,new:4,recommend:5},c=y(),p=b(),g=e(null),f=e(null),S=o({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",configType:3});c.beforeEach((e=>{["hot","new","recommend"].includes(e.name)&&(S.configType=u[e.name],S.currentPage=1,I())})),h((()=>{S.configType=u[p.name],I()}));const I=()=>{S.loading=!0,s.get("/indexConfigs",{params:{pageNumber:S.currentPage,pageSize:S.pageSize,configType:S.configType}}).then((e=>{S.tableData=e.list,S.total=e.totalCount,S.currentPage=e.currPage,S.loading=!1}))},P=()=>{S.type="add",f.value.open()},B=e=>{S.multipleSelection=e},D=()=>{S.multipleSelection.length?(console.log("删除"),s.delete("/indexConfigs",{data:{ids:S.multipleSelection.map((e=>e.configId))}}).then((()=>{d.success("删除成功"),I()}))):d.error("请选择项")},q=e=>{S.currentPage=e,I()};return(e,o)=>{const l=m,u=v,c=_,p=k,y=x,b=F;return a(),T(C,null,[n(b,{class:"index-container"},{header:r((()=>[t("div",N,[n(l,{type:"primary",icon:V(w),onClick:P},{default:r((()=>[i("增加")])),_:1},8,["icon"]),n(u,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:D},{reference:r((()=>[n(l,{type:"danger",icon:V(j)},{default:r((()=>[i("批量删除")])),_:1},8,["icon"])])),_:1})])])),default:r((()=>[n(p,{load:S.loading,ref_key:"multipleTable",ref:g,data:S.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:B},{default:r((()=>[n(c,{type:"selection",width:"55"}),n(c,{prop:"configName",label:"商品名称"}),n(c,{prop:"configRank",label:"排序值",width:"300"}),n(c,{prop:"goodsId",label:"商品编号",width:"300"}),n(c,{prop:"createTime",label:"添加时间",width:"300"}),n(c,{label:"操作",width:"100"},{default:r((e=>[t("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:o=>{return a=e.row.configId,S.type="edit",void f.value.open(a);var a}},"修改",8,z),n(u,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:o=>{return a=e.row.configId,console.log(a),void s.delete("/indexConfigs",{data:{ids:[a]}}).then((()=>{d.success("删除成功"),I()}));var a}},{reference:r((()=>[R])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["load","data"]),n(y,{background:"",layout:"prev, pager, next",total:S.total,"page-size":S.pageSize,"current-page":S.currentPage,onCurrentChange:q},null,8,["total","page-size","current-page"])])),_:1}),n(U,{ref_key:"addGood",ref:f,reload:I,type:S.type,configType:S.configType},null,8,["type","configType"])],64)}}},[["__scopeId","data-v-7eee142b"]]);export{B as default};
